# 家庭理财管理系统需求说明

## 1. 项目概述

本系统旨在帮助用户管理家庭资产负债，支持多成员家庭协同管理，追踪家庭整体财务状况，分析资产趋势，并提供智能化的理财建议。系统支持以家庭为单位统计所有成员的资产和负债，实现家庭财务的统一管理和分析。

## 2. 核心功能需求

### 2.1 家庭与用户管理

**功能要求：**
- ✅ 支持创建家庭，每个家庭有唯一的家庭名称
- ✅ 支持添加家庭成员（用户），每个用户归属于一个家庭
- ✅ 支持查看家庭成员列表
- ✅ 支持切换不同家庭进行查看和管理（TrendAnalysis页面已实现）
- ✅ 所有资产和负债都关联到具体的用户，通过用户关联到家庭
- ✅ 数据分析支持按家庭维度统计（汇总所有家庭成员的数据）
- ✅ 用户资料管理（UserProfile）
- ❌ 家庭成员权限管理（查看/编辑权限控制）

### 2.2 资产负债表管理

#### 2.2.1 资产管理

**资产类别：**
- ✅ 现金（Cash）
  - 银行存款
  - 手头现金
  - 货币基金
- ✅ 股票（Stocks）
  - 国内股票
  - 海外股票
  - 基金
- ✅ 退休基金（Retirement Funds）
  - 401k
  - IRA
  - 养老保险
- ✅ 保险（Insurance）
  - 人寿保险现金价值
  - 年金保险
- ✅ 房产（Real Estate）
  - 自住房产
  - 投资房产
- ✅ 数字货币（Cryptocurrency）
  - 比特币
  - 以太坊
  - 其他数字货币
- ✅ 贵金属（Precious Metals）
  - 黄金
  - 白银
  - 其他贵金属
- ✅ 经纪账户（Brokerage）

**税收状态分类：**
- ✅ 应税（TAXABLE）：需要缴纳资本利得税的资产
- ✅ 免税（TAX_FREE）：免税账户中的资产
- ✅ 延税（TAX_DEFERRED）：延迟缴税的资产（如401k、IRA等）

**功能要求：**
- ✅ 每种资产类别可以包含多个账号
- ✅ 每个资产账号归属于具体的家庭成员（用户）
- ✅ 支持录入某个时间点的资产数值（时间序列记录）
- ✅ 支持手动添加、编辑、删除资产账号
- ✅ 支持为每个账号设置别名和备注
- ✅ 支持设置资产账号的税收状态
- ✅ 支持批量更新资产数据（BatchUpdate.vue）
- ✅ 数据分析时可按家庭维度汇总所有成员的资产
- ✅ 支持多币种和汇率转换（ExchangeRateManagement）
- ✅ 查看账户历史记录（AccountHistory.vue）

#### 2.2.2 负债管理

**负债类别：**
- ✅ 房贷（Mortgage）
- ✅ 车贷（Auto Loan）
- ✅ 信用卡负债（Credit Card Debt）
- ✅ 个人借债（Personal Loan）
- ✅ 学生贷款（Student Loan）
- ✅ 其他负债（Other Debt）

**功能要求：**
- ✅ 每种负债类别可以包含多个账号
- ✅ 每个负债账号归属于具体的家庭成员（用户）
- ✅ 支持录入某个时间点的负债数值（时间序列记录）
- ✅ 支持记录利率、还款期限等信息
- ✅ 支持手动添加、编辑、删除负债账号（LiabilityList.vue, LiabilityDetail.vue）
- ✅ 支持批量更新负债数据（LiabilityBatchUpdate.vue）
- ✅ 负债在税收分析中默认作为免税处理
- ✅ 数据分析时可按家庭维度汇总所有成员的负债
- ✅ 查看负债历史记录（LiabilityHistory.vue）

### 2.3 数据录入

**功能要求：**
- ✅ 支持按时间点录入资产/负债数值（时间序列记录）
- ✅ 支持批量导入历史数据（BatchUpdate, LiabilityBatchUpdate）
- ❌ 支持设置定期提醒录入数据
- ✅ 数据录入支持多种货币（自动汇率转换，ExchangeRateManagement）
- ❌ 支持拍照上传账单凭证
- ✅ 自动检测重复记录并提示
- ✅ 自动填充历史数据功能

### 2.4 数据分析与可视化

#### 2.4.1 趋势分析（TrendAnalysis.vue）

- **单项资产趋势**
  - ✅ 折线图展示某种资产的时间趋势（Chart.js）
  - ✅ 显示增长率、波动率
  - ✅ 计算盈亏金额和百分比
  - ✅ 支持按家庭维度统计所有成员的资产

- **总资产趋势**
  - ✅ 总资产随时间的变化趋势
  - ✅ 净资产（总资产-总负债）趋势
  - ✅ 资产增长速度分析
  - ✅ 支持切换家庭查看不同家庭的趋势（家庭选择器）
  - ✅ 自动汇总选定家庭所有成员的数据
  - ✅ 多时间范围选择（本周/本月/本年/全部）
  - ✅ 支持多货币显示（USD/CNY）

#### 2.4.2 资产配置分析（AssetAllocation.vue）

- **资产占比**
  - ✅ 饼图展示各类资产的占比
  - ✅ 支持按大类或细分类别查看
  - ❌ 对比理想资产配置比例
  - ✅ 支持按家庭维度统计

- **负债占比**
  - ✅ 饼图展示各类负债的占比
  - ✅ 负债率（总负债/总资产）计算
  - ❌ 高风险负债预警
  - ✅ 支持按家庭维度统计

- **净资产分析**
  - ✅ 净资产分类饼图（资产-对应负债）
  - ✅ 税收状态分析（应税/免税/延税）
  - ✅ 负债优先抵扣应税资产，再抵扣免税和延税资产
  - ✅ 支持按指定日期查看历史数据
  - ✅ 支持多货币显示（USD/CNY）
  - ✅ 支持按家庭维度统计所有成员的净资产
  - ✅ 净资产分类映射配置（支持自定义资产类别到净资产分类的映射）

#### 2.4.3 财务指标（FinancialMetrics.vue）

- ✅ 总资产（Total Assets）- 支持按家庭维度统计
- ✅ 总负债（Total Liabilities）- 支持按家庭维度统计
- ✅ 净资产（Net Worth = 总资产 - 总负债）- 支持按家庭维度统计
- ✅ 资产负债率（Debt-to-Asset Ratio）
- ✅ 流动性比率（现金及现金等价物占比）
- ❌ 投资回报率（ROI）
- ✅ 月度/年度资产变化
- ✅ 所有指标支持家庭成员汇总计算
- ✅ 多货币显示支持（USD/CNY）
- ✅ 历史数据对比功能

### 2.5 智能分析与推荐

#### 2.5.1 风险评估（RiskAssessment.vue）

- ⚠️ 资产集中度风险分析（页面已创建，功能待完善）
- ⚠️ 负债压力评估（页面已创建，功能待完善）
- ⚠️ 流动性风险预警（页面已创建，功能待完善）
- ❌ 市场风险提示（针对股票、数字货币等）
- ⚠️ 支持按家庭维度进行风险评估（框架已支持）

#### 2.5.2 优化建议（OptimizationRecommendations.vue）

- ⚠️ 资产配置优化建议（页面已创建，功能待完善）
  - ❌ 根据家庭整体情况、年龄、风险偏好给出建议
  - ❌ 多元化投资建议
- ⚠️ 负债管理建议（页面已创建，功能待完善）
  - ❌ 高息负债优先偿还提醒
  - ❌ 债务整合建议
- ❌ 储蓄目标设定与追踪（支持家庭目标）
- ❌ 退休规划建议（家庭退休规划）

#### 2.5.3 目标管理

- ❌ 设置财务目标（如：买房首付、退休金目标等）
- ❌ 支持设置家庭目标和个人目标
- ❌ 追踪目标完成进度
- ❌ 预测目标达成时间
- ❌ 提供实现目标的行动建议

> **说明：** ⚠️ 表示页面框架已创建，但核心业务逻辑未实现或功能不完整

### 2.6 报表与导出

- ❌ 月度/季度/年度财务报表（支持家庭维度）
- ❌ 资产负债表导出（PDF/Excel）- 支持导出家庭整体报表
- ❌ 数据备份与恢复
- ❌ 多维度自定义报表
- ❌ 支持按家庭或个人维度生成报表

> **说明：** 报表导出功能尚未实现，但所有数据查询API已就绪，可基于现有API实现

## 3. 技术架构

### 3.1 后端
- **框架：** Java Spring Boot
- **数据库：** MySQL
- **API：** RESTful API

### 3.2 前端
- **框架：** Vue.js 3
- **UI库：** Element Plus
- **图表：** ECharts / Chart.js

### 3.3 数据库设计要点

**核心表结构：**
- 家庭表（families）- 存储家庭信息
- 用户表（users）- 存储用户信息，关联到家庭
- 资产类别表（asset_categories）
- 资产账号表（asset_accounts）- 关联到用户
- 资产记录表（asset_records）- 时间序列数据
- 负债类别表（liability_categories）
- 负债账号表（liability_accounts）- 关联到用户
- 负债记录表（liability_records）- 时间序列数据
- 财务目标表（financial_goals）- 支持家庭目标和个人目标

## 4. 用户体验要求

- ✅ 界面简洁直观，操作流程简单（基于Tailwind CSS + shadcn/ui设计）
- ⚠️ 支持移动端响应式设计（部分页面已适配，待全面优化）
- ✅ 数据可视化清晰美观（Chart.js图表）
- ❌ 支持暗色模式（CSS变量已配置，待启用）
- ⚠️ 数据安全加密存储（密码哈希存储，其他数据待加密）

## 5. 已实现功能

- ✅ 家庭管理（多成员支持）
- ✅ 按家庭维度统计资产负债
- ✅ 家庭切换功能
- ✅ 趋势分析支持家庭汇总

## 6. 未来扩展功能

- 家庭成员权限管理（查看/编辑权限）
- 自动同步银行账户数据
- AI智能理财顾问
- 社交分享（匿名）
- 理财知识库
- 税务规划工具
- 家庭财务报告自动生成
