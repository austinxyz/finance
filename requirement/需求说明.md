# 家庭理财管理系统需求说明

## 1. 项目概述

基于家庭为单位的财务管理系统，支持多成员协同管理，追踪资产负债，分析支出预算，提供智能理财建议。

## 2. 核心功能

### 2.1 家庭与用户管理

- ✅ 创建家庭，添加成员
- ✅ 家庭切换与多维度统计
- ✅ 用户资料管理
- ❌ 成员权限控制

### 2.2 支出管理

#### 分类体系
**10个大类**：子女👶 衣👔 食🍜 住🏠 行🚗 保险🛡️ 人情🎁 娱乐🎮 经营💼 其他📦

**支出类型**：
- 固定日常 - 房租水电等定期支出
- 大额不定期 - 旅游家电等偶发支出

**功能要点**：
- ✅ 自定义子分类管理（创建/编辑/软删除）
- ✅ 月度批量录入（显示3个月历史对比）
- ✅ 年度预算管理
- ✅ 多币种支持（7种货币：USD/CNY/EUR/GBP/JPY/AUD/CAD）
- ✅ 自动汇率转换
- ✅ 唯一性约束（家庭+周期+分类+币种）

#### 数据分析
- ✅ **三级钻取**：大类饼图 → 小类饼图 → 月度柱状图
- ✅ **预算执行**：预算vs实际对比，超支预警
- ✅ **统计模式**：同币种统计 / 交叉币种换算

### 2.3 资产负债管理

#### 资产类别（8类）
- 现金 - 银行存款、货币基金
- 股票 - 国内外股票、基金
- 退休基金 - 401k、IRA、养老保险
- 保险 - 人寿保险现金价值、年金
- 房产 - 自住房、投资房
- 数字货币 - 比特币、以太坊
- 贵金属 - 黄金、白银
- 经纪账户

**税收状态**：应税 / 免税 / 延税

#### 负债类别（7类）
房贷、车贷、信用卡、个人借债、学生贷款、商业贷款、其他

#### 功能特性
- ✅ 时序数据记录（多时间点快照）
- ✅ 批量更新
- ✅ 历史记录查询
- ✅ 多币种支持
- ✅ 税收状态分类
- ✅ 按家庭汇总

### 2.4 数据分析与可视化

#### 趋势分析
- ✅ 净资产趋势（总资产 - 总负债）
- ✅ 单项资产趋势（盈亏计算）
- ✅ 时间范围选择（周/月/年/全部）
- ✅ 多货币显示

#### 资产配置分析
- ✅ 资产占比饼图（大类/细分类）
- ✅ 负债占比与负债率
- ✅ 净资产分类（资产减对应负债）
- ✅ 税收状态分析（应税/免税/延税）
- ✅ 历史数据对比

#### 财务指标
- ✅ 总资产、总负债、净资产
- ✅ 资产负债率
- ✅ 流动性比率
- ✅ 月度/年度变化分析
- ❌ 投资回报率（ROI）

### 2.5 智能分析与推荐

#### 风险评估（框架已创建，功能待完善）
- ⚠️ 资产集中度风险
- ⚠️ 负债压力评估
- ⚠️ 流动性风险预警
- ❌ 市场风险提示

#### 优化建议（框架已创建，功能待完善）
- ⚠️ 资产配置优化
- ⚠️ 负债管理建议
- ❌ 储蓄目标追踪
- ❌ 退休规划

#### 目标管理（未实现）
- ❌ 财务目标设定（家庭/个人）
- ❌ 进度追踪与预测
- ❌ 行动建议

### 2.6 报表与导出

- ✅ Google Sheets导出（年度财务报表，6个工作表，异步导出，实时进度，权限管理）
- ❌ PDF/Excel本地导出
- ❌ 数据备份与恢复
- ❌ 月度/季度报表

## 3. 技术架构

### 后端
- Java 17 + Spring Boot 3.2
- MySQL 8.0 + Spring Data JPA
- RESTful API
- Flyway数据库迁移

### 前端
- Vue 3 (Composition API)
- Tailwind CSS + shadcn/ui
- Chart.js (数据可视化)
- Axios (API客户端)

### 数据库核心表
```
families                    # 家庭
users                       # 用户（关联家庭）
asset_type                  # 资产类型
asset_accounts              # 资产账户（关联用户）
asset_records               # 资产记录（时序数据）
liability_type              # 负债类型
liability_accounts          # 负债账户
liability_records           # 负债记录
expense_categories_major    # 支出大类
expense_categories_minor    # 支出小类
expense_records             # 支出记录（月度）
expense_budgets             # 年度预算
exchange_rates              # 汇率
annual_financial_summary    # 年度汇总
```

## 4. 用户体验

- ✅ 简洁界面（Tailwind CSS + shadcn/ui）
- ⚠️ 响应式设计（部分页面已适配）
- ✅ Chart.js可视化（智能格式化 ≥1M→X.XXM, ≥1K→X.XXK）
- ❌ 暗色模式（CSS变量已配置，待启用）
- ⚠️ 数据加密（密码哈希，其他数据待加密）

## 5. 实施状态

### ✅ 已完成
- 家庭管理（多成员、切换、汇总）
- 资产负债管理（8类资产、7类负债、批量更新、历史记录）
- 支出管理（分类、批量录入、预算、分析）
- 数据分析（趋势、配置、指标）
- 税收状态分类（应税/免税/延税）
- 多币种支持（7种货币、汇率管理）
- Google Sheets导出（年度财务报表、异步导出、实时进度、权限管理）
- 技术实现（100%单元测试覆盖率 33/33通过）

### ⚠️ 部分完成
- 风险评估（页面框架已创建）
- 优化建议（页面框架已创建）
- 响应式设计（部分页面）

### ❌ 未实现
- 成员权限管理
- 目标管理
- PDF/CSV导出
- 暗色模式
- 投资回报率（ROI）

## 6. 未来扩展

### 权限与安全
- 成员权限管理
- 数据加密存储
- 双因素认证
- 操作日志审计

### 数据集成
- 银行账户自动同步
- 信用卡账单导入
- 投资账户同步
- 电子发票识别（OCR）

### 智能分析
- AI理财顾问
- 支出异常检测
- 消费习惯分析
- 财务健康度评分

### 报表增强
- PDF/Excel本地导出
- 税务申报辅助
- 自定义报表模板
- 数据备份恢复

### 高级功能
- 税务规划工具
- 投资组合优化
- 退休规划计算器
- 教育基金规划

---

> **图标说明**：✅ 已完成 | ⚠️ 部分完成 | ❌ 未实现
